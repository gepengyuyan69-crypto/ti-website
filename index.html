<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ti---去中心化代币</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.6/lottie.min.js"></script>
<style>
body {margin:0;font-family:'Orbitron',sans-serif;background:#0f0c29;color:#fff;overflow-x:hidden;position:relative;}
header {text-align:center;padding:50px 20px 30px;z-index:10;position:relative;}
header h1 {font-size:3em;color:#00ffea;text-shadow:0 0 20px #00ffea,0 0 40px #ff00ff;animation:flicker 2s infinite;}
@keyframes flicker {0%,100% {opacity:1;}50% {opacity:0.6;}}
.token-info {text-align:center;margin:40px auto;background:rgba(0,255,234,0.1);padding:30px;border-radius:15px;box-shadow:0 0 40px #00ffea;max-width:500px;position:relative;z-index:10;}
.token-info h2 {font-size:2em;margin-bottom:15px;color:#ff00ff;}
.token-info p {font-size:1.2em;}
#swap-root {margin:50px auto;max-width:900px;padding:20px;border-radius:20px;background:rgba(255,0,255,0.05);box-shadow:0 0 50px #ff00ff;position:relative;z-index:10;}
.swap-section {display:flex;flex-direction:column;gap:15px;margin-top:20px;}
input[type="number"], select {width:100%;padding:12px;border-radius:12px;border:none;font-size:1em;text-align:right;}
.btn-swap,.btn-connect {padding:12px;font-size:1.2em;color:#fff;background:linear-gradient(45deg,#00ffea,#ff00ff);border:none;border-radius:12px;cursor:pointer;box-shadow:0 0 20px #ff00ff;transition:all 0.3s ease;}
.btn-swap:hover,.btn-connect:hover {transform:scale(1.05);box-shadow:0 0 30px #ff00ff,0 0 40px #00ffea;}
footer {text-align:center;padding:20px;color:#888;font-size:0.9em;position:relative;z-index:10;}
#mascot {position:absolute;bottom:20px;right:20px;width:220px;height:220px;z-index:9;cursor:pointer;user-select:none;}
#particleCanvas {position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;}
</style>
</head>
<body>
<canvas id="particleCanvas"></canvas>
<header>
<h1>Ti---去中心化代币</h1>
</header>
<div class="token-info">
<h2>Ti Token</h2>
<p>合约地址: <span id="tokenAddress">0x8b5be89c0f4eabbe51fd13cf21824b65b79527f3</span></p>
<p>价格: <span id="tokenPrice">加载中...</span> BNB</p>
<p>市值: <span id="tokenMarketCap">加载中...</span></p>
</div>
<div id="swap-root">
<button id="connectWallet" class="btn-connect">连接钱包</button>
<div class="swap-section" id="swap-ui" style="display:none;">
<select id="fromToken"><option value="BNB">BNB</option></select>
<input type="number" id="fromAmount" placeholder="输入金额" />
<select id="toToken"><option value="0x8b5be89c0f4eabbe51fd13cf21824b65b79527f3">Ti Token</option></select>
<input type="number" id="toAmount" placeholder="预计获得" disabled />
<button class="btn-swap" id="swapBtn">交换</button>
</div>
</div>
<div id="mascot"></div>
<footer>&copy; 2025 Ti Token | 去中心化，趣味无限</footer>

<script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
<script>
// Dexscreener 获取价格
async function fetchTokenInfo(){
try{
const res = await fetch('https://api.dexscreener.com/latest/dex/tokens/0x8b5be89c0f4eabbe51fd13cf21824b65b79527f3');
const data = await res.json();
const pair = data.pairs[0];
document.getElementById('tokenPrice').innerText = parseFloat(pair.priceUsd).toFixed(6);
document.getElementById('tokenMarketCap').innerText = '$'+parseFloat(pair.liquidity.usd).toLocaleString();
}catch(e){console.error(e);document.getElementById('tokenPrice').innerText='获取失败';document.getElementById('tokenMarketCap').innerText='获取失败';}}
fetchTokenInfo();

// Wallet & Swap
let web3, accounts;
const connectBtn=document.getElementById('connectWallet');
const swapUI=document.getElementById('swap-ui');
connectBtn.onclick=async()=>{
if(window.ethereum){
web3=new Web3(window.ethereum);
accounts=await window.ethereum.request({method:'eth_requestAccounts'});
connectBtn.innerText='已连接: '+accounts[0].slice(0,6)+'...'+accounts[0].slice(-4);
swapUI.style.display='flex';
}else{alert('请安装 MetaMask 或支持 WalletConnect 的钱包');}
};
const routerAddress='0x10ED43C718714eb63d5aA57B78B54704E256024E';
const routerAbi=[{"inputs":[{"internalType":"uint256","name":"amountOutMin","type":"uint256"},{"internalType":"address[]","name":"path","type":"address[]"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"name":"swapExactETHForTokens","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"payable","type":"function"}];

// 背景粒子
const canvas=document.getElementById('particleCanvas');const ctx=canvas.getContext('2d');canvas.width=window.innerWidth;canvas.height=window.innerHeight;const particles=[];for(let i=0;i<150;i++){particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*3+1,dx:(Math.random()-0.5)*0.5,dy:(Math.random()-0.5)*0.5,color:`hsl(${Math.random()*360},100%,70%)`});}
function animateParticles(){ctx.clearRect(0,0,canvas.width,canvas.height);for(let p of particles){p.x+=p.dx;p.y+=p.dy;if(p.x<0||p.x>canvas.width)p.dx*=-1;if(p.y<0||p.y>canvas.height)p.dy*=-1;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fillStyle=p.color;ctx.fill();}requestAnimationFrame(animateParticles);}
animateParticles();window.addEventListener('resize',()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;});

// 吉祥物 Lottie
const mascotAnimation=lottie.loadAnimation({container:document.getElementById('mascot'),renderer:'svg',loop:true,autoplay:true,path:'https://assets1.lottiefiles.com/packages/lf20_jxrxb6ci.json'});

// 输入金额动画加速
const fromAmountInput=document.getElementById('fromAmount');
fromAmountInput.addEventListener('input',()=>{mascotAnimation.setSpeed(1+Math.min(parseFloat(fromAmountInput.value)/10,2));});

// Swap 按钮悬停动画
const swapBtn=document.getElementById('swapBtn');
swapBtn.addEventListener('mouseenter',()=>{mascotAnimation.playSegments([0,50],true);});
swapBtn.addEventListener('mouseleave',()=>{mascotAnimation.playSegments([51,100],true);});

// 交易成功背景闪烁
function flashParticles(){for(let p of particles){p.color=`hsl(${Math.random()*360},100%,90%)`;}setTimeout(()=>{for(let p of particles){p.color=`hsl(${Math.random()*360},100%,70%)`; }},300);}

// Swap 点击事件
swapBtn.addEventListener('click',async()=>{
const fromAmount=document.getElementById('fromAmount').value;
if(!fromAmount||isNaN(fromAmount)||parseFloat(fromAmount)<=0)return alert('请输入正确金额');
const router=new web3.eth.Contract(routerAbi,routerAddress);
const toAddress='0x8b5be89c0f4eabbe51fd13cf21824b65b79527f3';
const path=['0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE',toAddress];
const deadline=Math.floor(Date.now()/1000)+60*10;
try{
await router.methods.swapExactETHForTokens(0,path,accounts[0],deadline).send({from:accounts[0],value:web3.utils.toWei(fromAmount,'ether')});
alert('交换成功');document.getElementById('fromAmount').value='';flashParticles();mascotAnimation.setSpeed(2);setTimeout(()=>{mascotAnimation.setSpeed(1);},500);
}catch(e){console.error(e);alert('交易失败');}});

// 鼠标拖动吉祥物
const mascot=document.getElementById('mascot');
let isDragging=false,offsetX=0,offsetY=0;
mascot.addEventListener('mousedown',(e)=>{isDragging=true;offsetX=e.clientX-mascot.offsetLeft;offsetY=e.clientY-mascot.offsetTop;});
document.addEventListener('mousemove',(e)=>{if(isDragging){mascot.style.left=(e.clientX-offsetX)+'px';mascot.style.top=(e.clientY-offsetY)+'px';}});
document.addEventListener('mouseup',()=>{isDragging=false;});

// 滚动漂浮效果
window.addEventListener('scroll',()=>{let scrollY=window.scrollY;mascot.style.transform=`translateY(${scrollY*0.1}px)`;});
</script>
</body>
</html>
